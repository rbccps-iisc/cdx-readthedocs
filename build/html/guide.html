

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Guide &mdash; CDX 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Documentation" href="apis.html" />
    <link rel="prev" title="Getting Started" href="gettingStarted.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> CDX
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gettingStarted.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cdx-configuration">CDX Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cdx-subsystems">CDX Subsystems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#api-gateway">API Gateway</a></li>
<li class="toctree-l3"><a class="reference internal" href="#broker">Broker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#catalog">Catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="#database">Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aaa-server">AAA Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#web-server">Web Server</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apis.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="cdxsubsystems.html">CDX Subsystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="cdxusers.html">CDX Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help and Support</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CDX</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="guide">
<h1>Guide<a class="headerlink" href="#guide" title="Permalink to this headline">¶</a></h1>
<p>This guide will help you understand the internals and operations of the CDX system.</p>
<div class="section" id="cdx-configuration">
<h2>CDX Configuration<a class="headerlink" href="#cdx-configuration" title="Permalink to this headline">¶</a></h2>
<p>Once we are done with setting up CDX, the configuration file <code class="docutils literal notranslate"><span class="pre">ideam.conf</span></code> will updated with the generated passwords for sub-systems</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">APIGATEWAY</span><span class="p">]</span>
<span class="n">https</span> <span class="o">=</span> <span class="mi">8443</span>

<span class="p">[</span><span class="n">BROKER</span><span class="p">]</span>
<span class="n">http</span> <span class="o">=</span> <span class="mi">12080</span>
<span class="n">management</span> <span class="o">=</span> <span class="mi">12081</span>
<span class="n">amqp</span> <span class="o">=</span> <span class="mi">12082</span>
<span class="n">mqtt</span> <span class="o">=</span> <span class="mi">12083</span>

<span class="p">[</span><span class="n">ELASTICSEARCH</span><span class="p">]</span>
<span class="n">elastic</span> <span class="o">=</span> <span class="mi">9200</span>
<span class="n">kibana</span> <span class="o">=</span> <span class="mi">13081</span>

<span class="p">[</span><span class="n">WEBSERVER</span><span class="p">]</span>
<span class="n">http</span> <span class="o">=</span> <span class="mi">14080</span>

<span class="p">[</span><span class="n">LDAP</span><span class="p">]</span>
<span class="n">ldap</span> <span class="o">=</span> <span class="mi">15389</span>

<span class="p">[</span><span class="n">CATALOGUE</span><span class="p">]</span>
<span class="n">http</span> <span class="o">=</span> <span class="mi">16080</span>

<span class="p">[</span><span class="n">KONGA</span><span class="p">]</span>
<span class="n">http</span> <span class="o">=</span> <span class="mi">17080</span>

<span class="p">[</span><span class="n">VIDEOSERVER</span><span class="p">]</span>
<span class="n">rtmp</span> <span class="o">=</span> <span class="mi">18935</span>
<span class="n">hls</span> <span class="o">=</span> <span class="mi">18080</span>
<span class="n">http</span> <span class="o">=</span> <span class="mi">18088</span>

<span class="p">[</span><span class="n">PASSWORDS</span><span class="p">]</span>
<span class="n">ldap</span> <span class="o">=</span> <span class="mi">721</span><span class="n">UD9ytc1Qc4ORT</span>
<span class="n">broker</span> <span class="o">=</span> <span class="mi">0</span><span class="n">Rv7MxG2uLsB2bgq</span>
<span class="n">cdx</span><span class="o">.</span><span class="n">admin</span> <span class="o">=</span> <span class="mi">0</span><span class="n">BsZmPezYrjbqS2CmYjtiP6ZfJfoKg4k</span>
<span class="n">database</span> <span class="o">=</span> <span class="mi">9</span><span class="n">SWhSOyVHHpIBrYDTI613o0YdCclVXc0MlG75y1VGfx</span>
</pre></div>
</div>
</div>
<div class="section" id="cdx-subsystems">
<h2>CDX Subsystems<a class="headerlink" href="#cdx-subsystems" title="Permalink to this headline">¶</a></h2>
<p>As explained earlier, CDX consists of multiple subsystems such as APIGateway, Data Broker, Media Broker, IoT Database, Authentication, Authorization and Accounting system etc.</p>
<p>In this section, we will have detailed usage guide for every subsystem. Let us first understand if all the subsystems are live and operating in the respective ports as per the config file provided. This can be verified by using the docker command</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">ps</span>
</pre></div>
</div>
<p>Which gives us the list of live containers running in the system as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONTAINER</span> <span class="n">ID</span>        <span class="n">IMAGE</span>                 <span class="n">COMMAND</span>                  <span class="n">CREATED</span>             <span class="n">STATUS</span>              <span class="n">PORTS</span>                                                                                                    <span class="n">NAMES</span>
<span class="mf">18e3864</span><span class="n">c3a46</span>        <span class="n">pantsel</span><span class="o">/</span><span class="n">konga</span>         <span class="s2">&quot;/app/start.sh&quot;</span>          <span class="mi">18</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">17</span> <span class="n">minutes</span>       <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">17080</span><span class="o">-&gt;</span><span class="mi">1337</span><span class="o">/</span><span class="n">tcp</span>                                                                                <span class="n">konga</span>
<span class="mi">80</span><span class="n">a390e62081</span>        <span class="n">ideam</span><span class="o">/</span><span class="n">videoserver</span>     <span class="s2">&quot;/usr/sbin/sshd -D&quot;</span>      <span class="mi">18</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">18</span> <span class="n">minutes</span>       <span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">18935</span><span class="o">-&gt;</span><span class="mi">1935</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">18080</span><span class="o">-&gt;</span><span class="mi">8080</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">18088</span><span class="o">-&gt;</span><span class="mi">8088</span><span class="o">/</span><span class="n">tcp</span>                        <span class="n">videoserver</span>
<span class="mi">8</span><span class="n">ed4e4b96ef6</span>        <span class="n">ideam</span><span class="o">/</span><span class="n">ldapd</span>           <span class="s2">&quot;/usr/sbin/sshd -D&quot;</span>      <span class="mi">18</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">18</span> <span class="n">minutes</span>       <span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">15389</span><span class="o">-&gt;</span><span class="mi">8389</span><span class="o">/</span><span class="n">tcp</span>                                                                        <span class="n">ldapd</span>
<span class="mi">67</span><span class="n">f990e9213c</span>        <span class="n">ideam</span><span class="o">/</span><span class="n">webserver</span>       <span class="s2">&quot;/bin/sh -c &#39;tail -f…&quot;</span>   <span class="mi">18</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">18</span> <span class="n">minutes</span>       <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">14080</span><span class="o">-&gt;</span><span class="mi">8080</span><span class="o">/</span><span class="n">tcp</span>                                                                                <span class="n">webserver</span>
<span class="mf">47e9730</span><span class="n">f4184</span>        <span class="n">ideam</span><span class="o">/</span><span class="n">elasticsearch</span>   <span class="s2">&quot;/usr/sbin/sshd -D&quot;</span>      <span class="mi">18</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">18</span> <span class="n">minutes</span>       <span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">9200</span><span class="o">-&gt;</span><span class="mi">9200</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">13081</span><span class="o">-&gt;</span><span class="mi">5601</span><span class="o">/</span><span class="n">tcp</span>                                              <span class="n">elasticsearch</span>
<span class="n">a3099a939d50</span>        <span class="n">ideam</span><span class="o">/</span><span class="n">broker</span>          <span class="s2">&quot;/bin/sh -c &#39;tail -f…&quot;</span>   <span class="mi">18</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">18</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">12083</span><span class="o">-&gt;</span><span class="mi">1883</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">12082</span><span class="o">-&gt;</span><span class="mi">5672</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">12080</span><span class="o">-&gt;</span><span class="mi">8000</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">12081</span><span class="o">-&gt;</span><span class="mi">15672</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">broker</span>
<span class="mi">98</span><span class="n">af3aa5c65f</span>        <span class="n">ideam</span><span class="o">/</span><span class="n">catalogue</span>       <span class="s2">&quot;/root/run.sh /usr/s…&quot;</span>   <span class="mi">19</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">18</span> <span class="n">minutes</span>       <span class="mi">22</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">27017</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">28017</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">16080</span><span class="o">-&gt;</span><span class="mi">8000</span><span class="o">/</span><span class="n">tcp</span>                                                  <span class="n">catalogue</span>
<span class="mi">306</span><span class="n">fd29f57c3</span>        <span class="n">ideam</span><span class="o">/</span><span class="n">apigateway</span>      <span class="s2">&quot;/docker-entrypoint.…&quot;</span>   <span class="mi">19</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">19</span> <span class="n">minutes</span>       <span class="mi">8000</span><span class="o">-</span><span class="mi">8001</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">8444</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8443</span><span class="o">-&gt;</span><span class="mi">8443</span><span class="o">/</span><span class="n">tcp</span>                                                          <span class="n">apigateway</span>
</pre></div>
</div>
<p>Each container is mapped to a specific port of the system to expose the APIs and services offered. If you look at the PORTS column, we have <code class="docutils literal notranslate"><span class="pre">PORT</span> <span class="pre">8443</span></code> of apigateway container mapped to <code class="docutils literal notranslate"><span class="pre">0.0.0.0:8443</span></code>. This exposes all the APIs offered by CDX to be accessed from external system. If we look at webserver, <code class="docutils literal notranslate"><span class="pre">PORT</span> <span class="pre">8080</span></code> is mapped to <code class="docutils literal notranslate"><span class="pre">127.0.0.1:14080</span></code>. This exposes the services offered by the webserver to be accessed only from CDX system.</p>
<p>In order to login to the specific container to view logs or for debugging, CDX provides shell access. The scripts for it is available in <code class="docutils literal notranslate"><span class="pre">ideam/shells</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="n">shells</span><span class="o">/</span>
<span class="n">apigateway</span><span class="o">*</span>  <span class="n">broker</span><span class="o">*</span>  <span class="n">catalogue</span><span class="o">*</span>  <span class="n">elasticsearch</span><span class="o">*</span>  <span class="n">ldapd</span><span class="o">*</span>  <span class="n">videoserver</span><span class="o">*</span>  <span class="n">webserver</span><span class="o">*</span>
</pre></div>
</div>
<p>For example, to login into webserver, you can execute the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shells</span><span class="o">/</span><span class="n">webserver</span>
</pre></div>
</div>
<p>Now you are in webserver container. To exit the container use <code class="docutils literal notranslate"><span class="pre">CTRL</span> <span class="pre">+</span> <span class="pre">D</span></code></p>
<p>If you have already registered the test device as explained in the Getting Started section you can skip this step. If not, let us now register a device and observe the sequence of events that happen in each subsystem.</p>
<p>To register a device run the <code class="docutils literal notranslate"><span class="pre">create_entity.sh</span></code> script <code class="docutils literal notranslate"><span class="pre">tests</span></code> directory with the ID <code class="docutils literal notranslate"><span class="pre">testStreetlight</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="n">tests</span><span class="o">/</span><span class="n">create_entity</span><span class="o">.</span><span class="n">sh</span> <span class="n">testStreetlight</span>
</pre></div>
</div>
<p>In the following subsections, we will observe the impact of registering <code class="docutils literal notranslate"><span class="pre">testStreetlight</span></code></p>
<div class="section" id="api-gateway">
<h3>API Gateway<a class="headerlink" href="#api-gateway" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="broker">
<h3>Broker<a class="headerlink" href="#broker" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="catalog">
<h3>Catalog<a class="headerlink" href="#catalog" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="database">
<h3>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="aaa-server">
<h3>AAA Server<a class="headerlink" href="#aaa-server" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="web-server">
<h3>Web Server<a class="headerlink" href="#web-server" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="apis.html" class="btn btn-neutral float-right" title="API Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gettingStarted.html" class="btn btn-neutral" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, RBCCPS, IISc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>